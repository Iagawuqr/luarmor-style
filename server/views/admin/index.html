<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Admin Panel - Shield v2.3</title>
<style>
/* CSS mantido igual */
:root{--bg:#0a0a0f;--card-bg:rgba(30,30,40,0.6);--border:rgba(255,255,255,0.08);--primary:#8b5cf6;--primary-hover:#7c3aed;--text:#fff;--text-muted:#9ca3af;--danger:#ef4444;--success:#22c55e;--warning:#f59e0b;--info:#3b82f6}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
body{font-family:'Segoe UI',Roboto,Helvetica,Arial,sans-serif;background:var(--bg);color:var(--text);min-height:100vh;overflow-x:hidden;font-size:14px}
h1,h2,h3{font-weight:600;letter-spacing:-0.5px}
code{font-family:monospace;background:rgba(0,0,0,0.3);padding:2px 6px;border-radius:4px;color:#e2e8f0;white-space:nowrap}
.hidden{display:none!important}
.spinner{width:24px;height:24px;border:3px solid rgba(255,255,255,0.1);border-top-color:var(--primary);border-radius:50%;animation:spin 1s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
.icon{width:18px;height:18px;fill:none;stroke:currentColor;stroke-width:2;stroke-linecap:round;stroke-linejoin:round}
.text-trunc{max-width:120px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;display:inline-block;vertical-align:bottom}
.app{display:flex;min-height:100vh}
.sidebar{width:260px;background:#111116;border-right:1px solid var(--border);position:fixed;height:100vh;z-index:50;transition:transform 0.3s cubic-bezier(0.4,0,0.2,1);display:flex;flex-direction:column}
.main-content{flex:1;margin-left:260px;padding:24px;width:100%}
.card{background:var(--card-bg);border:1px solid var(--border);border-radius:12px;overflow:hidden;margin-bottom:16px;backdrop-filter:blur(10px)}
.card-header{padding:16px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}
.card-title{font-size:16px;font-weight:600;display:flex;align-items:center;gap:8px}
.btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:10px 16px;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;border:none;transition:all 0.2s;text-decoration:none;user-select:none}
.btn:active{transform:scale(0.98)}
.btn-sm{padding:6px 12px;font-size:12px;height:32px}
.btn-primary{background:var(--primary);color:#fff;box-shadow:0 4px 12px rgba(139,92,246,0.3)}
.btn-secondary{background:rgba(255,255,255,0.08);color:#fff}
.btn-danger{background:rgba(239,68,68,0.15);color:var(--danger)}
.btn-success{background:rgba(34,197,94,0.15);color:var(--success)}
.btn-warning{background:rgba(245,158,11,0.15);color:var(--warning)}
.btn-info{background:rgba(59,130,246,0.15);color:var(--info)}
.form-group{margin-bottom:16px}
.form-label{display:block;margin-bottom:6px;color:var(--text-muted);font-size:13px}
.form-input,.form-select{width:100%;padding:10px 14px;background:rgba(0,0,0,0.2);border:1px solid var(--border);border-radius:8px;color:#fff;font-size:14px;transition:border-color 0.2s}
.form-input:focus{outline:none;border-color:var(--primary)}
.table-container{overflow-x:auto;-webkit-overflow-scrolling:touch}
.table{width:100%;border-collapse:collapse;min-width:600px}
.table th{text-align:left;padding:12px 16px;color:var(--text-muted);font-size:12px;text-transform:uppercase;border-bottom:1px solid var(--border);font-weight:600}
.table td{padding:12px 16px;border-bottom:1px solid var(--border);font-size:14px;white-space:nowrap}
.table tr:last-child td{border-bottom:none}
.table tr:hover td{background:rgba(255,255,255,0.02)}
.stat-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-bottom:24px}
.stat-card{padding:20px;display:flex;flex-direction:column}
.stat-value{font-size:28px;font-weight:700;margin-bottom:4px}
.stat-label{font-size:13px;color:var(--text-muted)}
.content-grid{display:grid;grid-template-columns:2fr 1fr;gap:16px}
.page-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px;flex-wrap:wrap;gap:16px}
.page-title h1{font-size:24px;margin-bottom:4px}
.page-actions{display:flex;gap:10px}
.sidebar-header{padding:24px;display:flex;align-items:center;gap:12px}
.logo-icon{width:32px;height:32px;background:var(--primary);border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:18px}
.logo-text{font-size:18px;font-weight:700}
.nav-item{padding:12px 24px;color:var(--text-muted);cursor:pointer;display:flex;align-items:center;gap:12px;transition:all 0.2s;font-size:14px;border-left:3px solid transparent}
.nav-item:hover{color:#fff;background:rgba(255,255,255,0.03)}
.nav-item.active{color:#fff;background:rgba(139,92,246,0.1);border-left-color:var(--primary)}
.nav-section{font-size:11px;text-transform:uppercase;color:#555;padding:20px 24px 8px;font-weight:700;letter-spacing:0.5px}
.login-wrap{display:flex;align-items:center;justify-content:center;min-height:100vh;padding:20px;position:fixed;inset:0;background:var(--bg);z-index:999}
.login-card{width:100%;max-width:400px;padding:40px;text-align:center}
.mobile-toggle{display:none;position:fixed;top:16px;left:16px;z-index:100;background:var(--card-bg);border:1px solid var(--border);border-radius:8px;padding:8px;color:#fff}
.sidebar-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.5);z-index:40;backdrop-filter:blur(2px)}
.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.8);z-index:90;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:0.2s}
.modal-overlay.active{opacity:1;pointer-events:auto}
.modal{width:90%;max-width:500px;background:#16161e;border-radius:12px;border:1px solid var(--border);transform:scale(0.95);transition:0.2s;max-height:90vh;display:flex;flex-direction:column}
.modal-overlay.active .modal{transform:scale(1)}
.modal-body{padding:20px;overflow-y:auto}
.modal-footer{padding:16px 20px;border-top:1px solid var(--border);display:flex;justify-content:flex-end;gap:10px}
.badge{padding:2px 8px;border-radius:12px;font-size:11px;font-weight:600;display:inline-block}
.badge-success{background:rgba(34,197,94,0.15);color:var(--success)}
.badge-danger{background:rgba(239,68,68,0.15);color:var(--danger)}
.badge-warning{background:rgba(245,158,11,0.15);color:var(--warning)}
.badge-info{background:rgba(59,130,246,0.15);color:var(--info)}
.badge-purple{background:rgba(139,92,246,0.15);color:var(--primary)}
.badge-secondary{background:rgba(255,255,255,0.08);color:var(--text-muted)}
.cell-stack{display:flex;gap:4px;flex-wrap:wrap}
.table-actions{display:flex;gap:4px;align-items:center}
.toggle-label{display:flex;align-items:center;gap:8px;cursor:pointer}
.toggle-input{display:none}
.toggle-switch{width:36px;height:20px;background:rgba(255,255,255,0.1);border-radius:10px;position:relative;transition:background 0.2s}
.toggle-switch::after{content:'';position:absolute;width:16px;height:16px;background:var(--text-muted);border-radius:50%;top:2px;left:2px;transition:transform 0.2s}
.toggle-input:checked+.toggle-switch{background:var(--primary)}
.toggle-input:checked+.toggle-switch::after{transform:translateX(16px);background:white}
.search-input-wrapper{position:relative}
.search-icon{position:absolute;left:12px;top:50%;transform:translateY(-50%);color:var(--text-muted)}
.empty-state{padding:40px;text-align:center}
.empty-state-icon{font-size:48px;margin-bottom:16px;opacity:0.5}
.empty-state-title{font-size:18px;font-weight:600;margin-bottom:8px}
.empty-state-text{color:var(--text-muted);font-size:14px;max-width:300px;margin:0 auto}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
@keyframes fadeInUp{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
.animate-fadeIn{animation:fadeIn 0.3s ease}
.animate-fadeInUp{animation:fadeInUp 0.4s ease}
.checkbox-label{display:flex;align-items:center;gap:8px;cursor:pointer}
.checkbox-input{display:none}
.checkbox-custom{width:16px;height:16px;border:2px solid var(--border);border-radius:4px;position:relative;transition:all 0.2s}
.checkbox-input:checked+.checkbox-custom{background:var(--primary);border-color:var(--primary)}
.checkbox-input:checked+.checkbox-custom::after{content:'';position:absolute;left:4px;top:1px;width:5px;height:9px;border:solid white;border-width:0 2px 2px 0;transform:rotate(45deg)}
.checkbox-group{display:flex;flex-direction:column;gap:8px}
@media (max-width: 768px) {
    .sidebar{transform:translateX(-100%)}
    .sidebar.open{transform:translateX(0)}
    .main-content{margin-left:0;padding:16px;padding-top:70px}
    .mobile-toggle{display:block}
    .sidebar-overlay.open{display:block}
    .page-header{flex-direction:column;align-items:flex-start;gap:16px}
    .page-actions{width:100%;display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .page-actions .btn{width:100%}
    .stat-grid{grid-template-columns:1fr 1fr!important}
    .content-grid{grid-template-columns:1fr!important}
    .table{font-size:13px}
    .table th,.table td{padding:10px}
}
@media (max-width: 480px) {
    .stat-grid{grid-template-columns:1fr!important}
}
</style>
</head>
<body>

<button class="mobile-toggle" onclick="App.toggleSidebar()">
    <svg class="icon" viewBox="0 0 24 24"><path d="M3 12h18M3 6h18M3 18h18"></path></svg>
</button>

<div id="loginScreen" class="login-wrap">
    <div class="card login-card">
        <div style="font-size:40px;margin-bottom:16px">üõ°Ô∏è</div>
        <h2 style="margin-bottom:8px">Admin Access</h2>
        <p style="margin-bottom:24px">Enter security key to continue</p>
        <div id="loginError" class="badge badge-danger hidden" style="margin-bottom:16px;display:none">Invalid Key</div>
        <input type="password" id="adminKeyInput" class="form-input" placeholder="Admin Key..." style="margin-bottom:16px;text-align:center">
        <button id="loginBtn" class="btn btn-primary" style="width:100%">Verify Access</button>
    </div>
</div>

<div id="dashboardScreen" class="app hidden">
    <div class="sidebar-overlay" onclick="App.toggleSidebar()"></div>
    <aside class="sidebar">
        <div class="sidebar-header"><div class="logo-icon">üõ°Ô∏è</div><div class="logo-text">Shield</div></div>
        <div style="flex:1;overflow-y:auto">
            <div class="nav-section">Analytics</div>
            <div class="nav-item active" data-page="dashboard"><svg class="icon" viewBox="0 0 24 24"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg> Dashboard</div>
            <div class="nav-item" data-page="logs"><svg class="icon" viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg> Logs</div>
            <div class="nav-section">Management</div>
            <div class="nav-item" data-page="sessions"><svg class="icon" viewBox="0 0 24 24"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg> Sessions</div>
            <div class="nav-item" data-page="bans"><svg class="icon" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"></circle><line x1="4.93" y1="4.93" x2="19.07" y2="19.07"></line></svg> Bans</div>
            <div class="nav-item" data-page="suspended"><svg class="icon" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"></circle><line x1="10" y1="15" x2="10" y2="9"></line><line x1="14" y1="15" x2="14" y2="9"></line></svg> Suspended</div>
            <div class="nav-item" data-page="whitelist"><svg class="icon" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg> Whitelist</div>
            <div class="nav-item" data-page="keys"><svg class="icon" viewBox="0 0 24 24"><path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"></path></svg> Keys</div>
            <div class="nav-section">System</div>
            <div class="nav-item" data-page="settings"><svg class="icon" viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg> Settings</div>
        </div>
        <div style="padding:16px;border-top:1px solid var(--border)">
            <div class="nav-item" onclick="Auth.logout()" style="color:var(--danger)"><svg class="icon" viewBox="0 0 24 24"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg> Logout</div>
        </div>
    </aside>
    <main class="main-content"><div id="pageContent"><div style="text-align:center;padding:60px"><div class="spinner"></div></div></div></main>
</div>

<div id="generalModal" class="modal-overlay">
    <div class="modal">
        <div class="modal-header"><h3 class="modal-title" id="modalTitle">Title</h3><button class="btn btn-secondary btn-sm" onclick="App.closeModal()">‚úï</button></div>
        <div class="modal-body" id="modalBody"></div>
        <div class="modal-footer" id="modalFooter"></div>
    </div>
</div>
<div id="toastContainer" class="toast-container"></div>

<script>
// === CONFIG & UTILS ===
const CONFIG = {
    API_BASE: window.location.origin,
    CURRENT_KEY: localStorage.getItem('ak') || null
};

const Utils = {
    toast(msg, type = 'info') {
        const c = document.getElementById('toastContainer');
        const d = document.createElement('div');
        d.className = 'toast';
        d.style.cssText = `
            background: var(--card-bg);
            border-left: 4px solid ${type === 'success' ? 'var(--success)' : type === 'error' ? 'var(--danger)' : type === 'warning' ? 'var(--warning)' : 'var(--primary)'};
            padding: 12px 16px;
            margin-bottom: 8px;
            border-radius: 6px;
            animation: slideIn 0.3s ease;
        `;
        d.innerHTML = msg;
        c.appendChild(d);
        setTimeout(() => d.remove(), 3000);
    },
    
    fmtDate(d) {
        try { return new Date(d).toLocaleString(); } catch { return '-'; }
    },
    
    esc(s) {
        return s ? String(s).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;") : '-';
    },
    
    trunc(s, l = 15) {
        return s && s.length > l ? `<span class="text-trunc" title="${s}">${s.substring(0, l)}...</span>` : s || '-';
    },
    
    async confirm(msg, title = 'Confirm') {
        return window.confirm(title + '\n\n' + msg);
    },
    
    setLoading(el, loading) {
        if (!el) return;
        if (loading) {
            el.disabled = true;
            el.dataset.oldText = el.textContent;
            el.textContent = 'Loading...';
        } else {
            el.disabled = false;
            if (el.dataset.oldText) el.textContent = el.dataset.oldText;
        }
    },
    
    debounce(fn, wait = 300) {
        let timeout;
        return function(...args) {
            clearTimeout(timeout);
            timeout = setTimeout(() => fn.apply(this, args), wait);
        };
    }
};

// === API ===
const API = {
    async req(endpoint, options = {}) {
        if (!CONFIG.CURRENT_KEY) {
            return { success: false, error: 'No authentication key' };
        }
        
        try {
            const response = await fetch(CONFIG.API_BASE + endpoint, {
                ...options,
                headers: {
                    ...options.headers,
                    'Content-Type': 'application/json',
                    'x-admin-key': CONFIG.CURRENT_KEY
                }
            });
            return await response.json();
        } catch (e) {
            return { success: false, error: e.message };
        }
    },
    
    get(endpoint, params) {
        const query = params ? '?' + new URLSearchParams(params).toString() : '';
        return this.req(endpoint + query);
    },
    
    post(endpoint, body) {
        return this.req(endpoint, { 
            method: 'POST', 
            body: JSON.stringify(body) 
        });
    },
    
    delete(endpoint, body = null) {
        return this.req(endpoint, { 
            method: 'DELETE', 
            body: body ? JSON.stringify(body) : null 
        });
    }
};

// === AUTH ===
const Auth = {
    async check() {
        const r = await API.get('/api/admin/stats');
        if (r.success) return true;
        localStorage.removeItem('ak');
        CONFIG.CURRENT_KEY = null;
        return false;
    },
    
    async login() {
        const key = document.getElementById('adminKeyInput').value;
        const btn = document.getElementById('loginBtn');
        const errorEl = document.getElementById('loginError');
        
        if (!key) {
            errorEl.textContent = 'Please enter admin key';
            errorEl.style.display = 'block';
            return;
        }
        
        btn.disabled = true;
        btn.textContent = 'Verifying...';
        errorEl.style.display = 'none';
        
        localStorage.setItem('ak', key);
        CONFIG.CURRENT_KEY = key;
        
        if (await this.check()) {
            App.showDash();
        } else {
            errorEl.textContent = 'Invalid admin key';
            errorEl.style.display = 'block';
            btn.disabled = false;
            btn.textContent = 'Verify Access';
        }
    },
    
    logout() {
        localStorage.removeItem('ak');
        CONFIG.CURRENT_KEY = null;
        location.reload();
    }
};

// === KEYS MODULE ===
const Keys = {
    keys: [],
    searchQuery: '',
    
    async init() {
        await this.loadKeys();
        this.bindEvents();
        this.updateStats();
    },
    
    async loadKeys() {
        const result = await API.get('/api/admin/keys');
        if (result.success) {
            this.keys = result.keys || [];
            this.renderTable();
        } else {
            Utils.toast('Failed to load keys', 'error');
        }
    },
    
    filterKeys() {
        if (!this.searchQuery) return this.keys;
        const query = this.searchQuery.toLowerCase();
        return this.keys.filter(key => 
            (key.key && key.key.toLowerCase().includes(query)) ||
            (key.note && key.note.toLowerCase().includes(query))
        );
    },
    
    renderTable() {
        const tbody = document.getElementById('keysTableBody');
        if (!tbody) return;
        
        const filteredKeys = this.filterKeys();
        
        if (filteredKeys.length === 0) {
            tbody.innerHTML = `
                <tr>
                    <td colspan="9" class="text-center" style="padding: 40px;">
                        <div class="empty-state">
                            <div class="empty-state-icon">üîë</div>
                            <h4 class="empty-state-title">No keys found</h4>
                            <p class="empty-state-text">
                                ${this.searchQuery ? 'Try a different search term' : 'Create your first key'}
                            </p>
                        </div>
                    </td>
                </tr>
            `;
            return;
        }
        
        tbody.innerHTML = filteredKeys.map(key => `
            <tr class="animate-fadeIn">
                <td><code class="text-primary" style="font-weight: bold;">${Utils.esc(key.key)}</code></td>
                <td class="text-secondary">${Utils.esc(key.note || '-')}</td>
                <td>
                    <span class="badge ${key.enabled ? 'badge-success' : 'badge-danger'}">
                        ${key.enabled ? '‚úÖ Active' : '‚ùå Disabled'}
                    </span>
                </td>
                <td>
                    <span class="badge ${key.usesLeft > 0 ? 'badge-info' : 'badge-warning'}">
                        ${key.usesLeft}/${key.usesTotal}
                    </span>
                </td>
                <td>
                    ${key.expiryFormatted === 'Never' ? 
                        '<span class="badge badge-secondary">Never</span>' : 
                        `<span class="badge ${key.expiryFormatted.includes('Expired') ? 'badge-danger' : 'badge-warning'}">
                            ${key.expiryFormatted}
                        </span>`
                    }
                </td>
                <td class="text-muted" style="font-size: 12px;">${Utils.fmtDate(key.createdAt)}</td>
                <td>
                    <div class="cell-stack">
                        ${key.hwidLock ? '<span class="badge badge-purple">HWID</span>' : ''}
                        ${key.ipLock ? '<span class="badge badge-info">IP</span>' : ''}
                        ${key.userIdLock ? '<span class="badge badge-warning">UID</span>' : ''}
                    </div>
                </td>
                <td class="text-muted" style="font-size: 12px;">
                    ${key.lastUsed ? Utils.fmtDate(key.lastUsed) : 'Never'}
                </td>
                <td>
                    <div class="table-actions">
                        <button class="btn btn-ghost btn-sm" onclick="Keys.copyKey('${key.key}')" title="Copy Key">
                            üìã
                        </button>
                        <button class="btn btn-${key.enabled ? 'warning' : 'success'} btn-sm" 
                                onclick="Keys.toggleKey('${key.key}', ${!key.enabled})" 
                                title="${key.enabled ? 'Disable' : 'Enable'}">
                            ${key.enabled ? '‚è∏Ô∏è' : '‚ñ∂Ô∏è'}
                        </button>
                        <button class="btn btn-danger btn-sm" onclick="Keys.deleteKey('${key.key}')" title="Delete">
                            üóëÔ∏è
                        </button>
                    </div>
                </td>
            </tr>
        `).join('');
    },
    
    bindEvents() {
        const searchInput = document.getElementById('keySearch');
        if (searchInput) {
            searchInput.addEventListener('input', Utils.debounce((e) => {
                this.searchQuery = e.target.value;
                this.renderTable();
            }, 300));
        }
        
        document.getElementById('createKeyBtn')?.addEventListener('click', () => this.openCreateModal());
    },
    
    openCreateModal() {
        const modal = document.getElementById('createKeyModal');
        if (modal) {
            modal.classList.add('active');
            document.getElementById('keyNote').value = '';
            document.getElementById('keyDays').value = '7';
            document.getElementById('keyHours').value = '0';
            document.getElementById('keyUses').value = '1';
            document.getElementById('keyHwidLock').checked = true;
            document.getElementById('keyIpLock').checked = false;
            document.getElementById('keyUserIdLock').checked = false;
        }
    },
    
    closeCreateModal() {
        const modal = document.getElementById('createKeyModal');
        if (modal) modal.classList.remove('active');
    },
    
    async createKey() {
        const note = document.getElementById('keyNote').value.trim();
        const days = parseInt(document.getElementById('keyDays').value) || 0;
        const hours = parseInt(document.getElementById('keyHours').value) || 0;
        const uses = parseInt(document.getElementById('keyUses').value) || 1;
        const hwidLock = document.getElementById('keyHwidLock').checked;
        const ipLock = document.getElementById('keyIpLock').checked;
        const userIdLock = document.getElementById('keyUserIdLock').checked;
        
        if (uses < 1) {
            Utils.toast('Uses must be at least 1', 'error');
            return;
        }
        
        const btn = document.getElementById('createKeySubmitBtn');
        Utils.setLoading(btn, true);
        
        try {
            const result = await API.post('/api/admin/keys/create', {
                note,
                days,
                hours,
                uses,
                hwidLock,
                ipLock,
                userIdLock
            });
            
            if (result.success) {
                Utils.toast(`Key created: ${result.key}`, 'success');
                this.closeCreateModal();
                
                // Show new key
                const keyDisplay = document.getElementById('newKeyDisplay');
                const keyCode = document.getElementById('newKeyCode');
                
                if (keyDisplay && keyCode) {
                    keyDisplay.textContent = result.key;
                    keyCode.textContent = `_G.key = "${result.key}"`;
                    document.getElementById('newKeyModal').classList.add('active');
                }
                
                await this.loadKeys();
            } else {
                Utils.toast(result.error || 'Failed to create key', 'error');
            }
        } catch (error) {
            Utils.toast('Error: ' + error.message, 'error');
        } finally {
            Utils.setLoading(btn, false);
        }
    },
    
    async deleteKey(keyString) {
        if (!await Utils.confirm(`Delete key ${keyString}?\nThis cannot be undone!`, 'Delete Key')) {
            return;
        }
        
        const result = await API.delete(`/api/admin/keys/${encodeURIComponent(keyString)}`);
        
        if (result.success) {
            Utils.toast('Key deleted', 'success');
            await this.loadKeys();
        } else {
            Utils.toast(result.error || 'Failed to delete key', 'error');
        }
    },
    
    async toggleKey(keyString, enable) {
        const endpoint = enable ? 'enable' : 'disable';
        const result = await API.post(`/api/admin/keys/${encodeURIComponent(keyString)}/${endpoint}`);
        
        if (result.success) {
            Utils.toast(`Key ${enable ? 'enabled' : 'disabled'}`, 'success');
            await this.loadKeys();
        } else {
            Utils.toast(result.error || 'Failed to toggle key', 'error');
        }
    },
    
    copyKey(keyString) {
        navigator.clipboard.writeText(keyString)
            .then(() => Utils.toast('Key copied to clipboard', 'success'))
            .catch(() => Utils.toast('Failed to copy', 'error'));
    },
    
    closeNewKeyModal() {
        document.getElementById('newKeyModal')?.classList.remove('active');
    },
    
    copyKeyCode() {
        const codeElement = document.getElementById('newKeyCode');
        if (codeElement) {
            navigator.clipboard.writeText(codeElement.textContent)
                .then(() => Utils.toast('Code copied', 'success'))
                .catch(() => Utils.toast('Failed to copy', 'error'));
        }
    },
    
    async updateStats() {
        try {
            const result = await API.get('/api/admin/keys/stats/overview');
            if (result.success) {
                const stats = result.stats;
                const statsEl = document.getElementById('keysStats');
                if (statsEl) {
                    statsEl.innerHTML = `
                        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 24px;">
                            <div class="card stat-card">
                                <div class="stat-value">${stats.totalKeys}</div>
                                <div class="stat-label">Total Keys</div>
                            </div>
                            <div class="card stat-card">
                                <div class="stat-value" style="color: var(--success)">${stats.activeKeys}</div>
                                <div class="stat-label">Active Keys</div>
                            </div>
                            <div class="card stat-card">
                                <div class="stat-value" style="color: var(--danger)">${stats.expiredKeys}</div>
                                <div class="stat-label">Expired Keys</div>
                            </div>
                            <div class="card stat-card">
                                <div class="stat-value" style="color: var(--primary)">${stats.totalActivations}</div>
                                <div class="stat-label">Total Activations</div>
                            </div>
                        </div>
                    `;
                }
            }
        } catch (error) {
            console.error('Failed to load key stats:', error);
        }
    },
    
    async refresh() {
        await this.loadKeys();
        await this.updateStats();
        Utils.toast('Keys refreshed', 'success');
    },
    
    render() {
        return `
            <div class="page-header">
                <div>
                    <h1 class="page-title">üîë Key Management</h1>
                    <p class="page-subtitle">Create and manage activation keys</p>
                </div>
                <div class="page-actions">
                    <button class="btn btn-secondary" onclick="Keys.refresh()">
                        ‚Üª Refresh
                    </button>
                    <button class="btn btn-primary" id="createKeyBtn">
                        ‚ûï Create Key
                    </button>
                </div>
            </div>
            
            <div id="keysStats"></div>
            
            <div class="card animate-fadeInUp">
                <div class="card-header">
                    <div class="actions-left">
                        <div class="search-input-wrapper">
                            <span class="search-icon">üîç</span>
                            <input type="text" id="keySearch" class="form-input search-input" placeholder="Search keys..." style="padding-left: 40px; width: 300px;">
                        </div>
                    </div>
                </div>
                <div class="table-container">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Key</th>
                                <th>Note</th>
                                <th>Status</th>
                                <th>Uses</th>
                                <th>Expires</th>
                                <th>Created</th>
                                <th>Locks</th>
                                <th>Last Used</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="keysTableBody">
                            <tr>
                                <td colspan="9" class="text-center" style="padding: 40px;">
                                    <div class="spinner"></div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Create Key Modal -->
            <div class="modal-overlay" id="createKeyModal">
                <div class="modal" style="max-width: 600px;">
                    <div class="modal-header">
                        <h3 class="modal-title">‚ûï Create New Key</h3>
                        <button class="modal-close" onclick="Keys.closeCreateModal()">‚úï</button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label class="form-label">Note (Optional)</label>
                            <input type="text" id="keyNote" class="form-input" placeholder="e.g., VIP Customer">
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 16px;">
                            <div class="form-group">
                                <label class="form-label">Days</label>
                                <input type="number" id="keyDays" class="form-input" value="7" min="0">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Hours</label>
                                <input type="number" id="keyHours" class="form-input" value="0" min="0" max="23">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Number of Uses</label>
                            <input type="number" id="keyUses" class="form-input" value="1" min="1">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Security Locks</label>
                            <div class="checkbox-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="keyHwidLock" checked class="checkbox-input">
                                    <span class="checkbox-custom"></span>
                                    <span class="checkbox-text">Lock to HWID (Device)</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="keyIpLock" class="checkbox-input">
                                    <span class="checkbox-custom"></span>
                                    <span class="checkbox-text">Lock to IP Address</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="keyUserIdLock" class="checkbox-input">
                                    <span class="checkbox-custom"></span>
                                    <span class="checkbox-text">Lock to User ID</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" onclick="Keys.closeCreateModal()">Cancel</button>
                        <button class="btn btn-primary" id="createKeySubmitBtn" onclick="Keys.createKey()">
                            Create Key
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- New Key Created Modal -->
            <div class="modal-overlay" id="newKeyModal">
                <div class="modal">
                    <div class="modal-header">
                        <h3 class="modal-title">üéâ Key Created Successfully</h3>
                        <button class="modal-close" onclick="Keys.closeNewKeyModal()">‚úï</button>
                    </div>
                    <div class="modal-body">
                        <div style="text-align: center; padding: 20px;">
                            <div style="font-size: 48px; margin-bottom: 20px;">üîë</div>
                            <h4 style="margin-bottom: 10px; color: var(--success);">Your New Key:</h4>
                            <code id="newKeyDisplay" style="display: block; padding: 15px; background: rgba(139, 92, 246, 0.1); border-radius: 8px; font-size: 18px; font-weight: bold; margin-bottom: 30px; border: 1px solid var(--primary);"></code>
                            
                            <h4 style="margin-bottom: 10px;">Executor Code:</h4>
                            <pre id="newKeyCode" style="padding: 15px; background: #1a1a2e; border-radius: 8px; overflow-x: auto; text-align: left; font-family: monospace; font-size: 14px; border: 1px solid var(--border);"></pre>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" onclick="Keys.closeNewKeyModal()">Close</button>
                        <button class="btn btn-primary" onclick="Keys.copyKeyCode()">
                            üìã Copy Code
                        </button>
                    </div>
                </div>
            </div>
        `;
    }
};

// === EXISTING MODULES (SIMPLIFIED) ===
const Dashboard = {
    async render() {
        try {
            const r = await API.get('/api/admin/stats');
            if (!r.success) throw new Error("API Error");
            const s = r.stats || {};
            return `<div class="page-header"><div class="page-title"><h1>Dashboard</h1><p>System Overview</p></div><div class="page-actions"><button class="btn btn-secondary" onclick="App.nav('dashboard')">‚Üª Refresh</button></div></div>
            <div class="stat-grid">
                <div class="card stat-card"><div class="stat-value">${s.sessions||0}</div><div class="stat-label">Active Sessions</div></div>
                <div class="card stat-card"><div class="stat-value" style="color:var(--success)">${s.success||0}</div><div class="stat-label">Successful Loads</div></div>
                <div class="card stat-card"><div class="stat-value" style="color:var(--danger)">${s.bans||0}</div><div class="stat-label">Total Bans</div></div>
                <div class="card stat-card"><div class="stat-value" style="color:var(--warning)">${s.challenges||0}</div><div class="stat-label">Challenges</div></div>
            </div>
            <div class="content-grid">
                <div class="card"><div class="card-header"><span class="card-title">Recent Activity</span></div><div id="recentLogs" style="padding:16px"><div class="spinner"></div></div></div>
                <div class="card"><div class="card-header"><span class="card-title">Quick Actions</span></div><div style="padding:16px;display:flex;flex-direction:column;gap:8px"><button class="btn btn-secondary" onclick="App.nav('sessions')">Manage Sessions</button><button class="btn btn-secondary" onclick="App.nav('bans')">Manage Bans</button><button class="btn btn-danger" onclick="Dashboard.clearCache()">Clear Cache</button></div></div>
            </div>`;
        } catch(e) { return `<div style="padding:40px;text-align:center;color:var(--danger)">Failed to load stats</div>`; }
    },
    async postRender() {
        const r = await API.get('/api/admin/logs',{limit:5});
        const logs = r.logs || [];
        document.getElementById('recentLogs').innerHTML = logs.map(l => `
            <div style="display:flex;justify-content:space-between;border-bottom:1px solid var(--border);padding:8px 0;font-size:13px">
                <div><span style="color:${l.success?'var(--success)':'var(--danger)'}">‚óè</span> ${Utils.esc(l.action)}</div>
                <div style="color:#666">${Utils.trunc(l.ip,12)}</div>
            </div>
        `).join('') || '<p style="text-align:center">No activity</p>';
    },
    async clearCache() { if(confirm('Clear cache?')) { await API.post('/api/admin/cache/clear'); Utils.toast('Cache cleared','success'); } }
};

const Bans = {
    async render() {
        const r = await API.get('/api/admin/bans');
        return `<div class="page-header"><div class="page-title"><h1>Bans</h1><p>Blocked Users</p></div><div class="page-actions"><button class="btn btn-secondary" onclick="App.nav('bans')">‚Üª Refresh</button><button class="btn btn-primary" onclick="Bans.modal()">‚ûï Ban</button></div></div><div class="card table-container"><table class="table"><thead><tr><th>Target</th><th>Reason</th><th>Date</th><th>Action</th></tr></thead><tbody>${(r.bans||[]).map(b=>`<tr><td><code>${Utils.trunc(b.hwid||b.playerId||b.ip,20)}</code></td><td>${Utils.trunc(b.reason)}</td><td>${Utils.fmtDate(b.ts)}</td><td><button class="btn btn-danger btn-sm" onclick="Bans.del('${b.banId}')">üóëÔ∏è</button></td></tr>`).join('')||'<tr><td colspan="4" style="text-align:center">No bans</td></tr>'}</tbody></table></div>`;
    },
    async del(id){ if(confirm('Unban?')){ await API.delete('/api/admin/bans/'+id); App.nav('bans'); Utils.toast('Unbanned','success'); } },
    modal(){ App.openModal('Add Ban',`<div class="form-group"><label class="form-label">HWID / UserID / IP</label><input id="banVal" class="form-input"></div><div class="form-group"><label class="form-label">Reason</label><input id="banRes" class="form-input" value="Manual Ban"></div>`,`<button class="btn btn-danger" onclick="Bans.add()">Ban User</button>`) },
    async add(){ const v=document.getElementById('banVal').value,r=document.getElementById('banRes').value; if(v){ await API.post('/api/admin/bans',{hwid:v,reason:r}); App.closeModal(); App.nav('bans'); } }
};

const Sessions = {
    async render() {
        const r = await API.get('/api/admin/sessions');
        return `<div class="page-header"><div class="page-title"><h1>Sessions</h1><p>${(r.sessions||[]).length} Active</p></div><div class="page-actions"><button class="btn btn-secondary" onclick="App.nav('sessions')">‚Üª Refresh</button><button class="btn btn-danger" onclick="Sessions.killAll()">üíÄ Kill All</button></div></div><div class="card table-container"><table class="table"><thead><tr><th>ID</th><th>User</th><th>HWID</th><th>Action</th></tr></thead><tbody>${(r.sessions||[]).map(s=>`<tr><td><code>${Utils.trunc(s.sessionId,8)}</code></td><td>${s.userId||'-'}</td><td><code>${Utils.trunc(s.hwid,10)}</code></td><td><button class="btn btn-secondary btn-sm" onclick="Sessions.suspend('${s.sessionId}')">‚è∏Ô∏è</button> <button class="btn btn-danger btn-sm" onclick="Sessions.kill('${s.sessionId}')">üíÄ</button></td></tr>`).join('')||'<tr><td colspan="4" style="text-align:center">No sessions</td></tr>'}</tbody></table></div>`;
    },
    async kill(sid){ if(confirm('Kill?')){ await API.post('/api/admin/kill-session',{sessionId:sid}); App.nav('sessions'); } },
    async killAll(){ if(confirm('Kill ALL?')){ await API.post('/api/admin/sessions/clear'); App.nav('sessions'); } },
    suspend(sid){ App.openModal('Suspend Session',`<div class="form-group"><label class="form-label">Duration (sec)</label><input id="suspDur" class="form-input" type="number"></div><div class="form-group"><label class="form-label">Reason</label><input id="suspRes" class="form-input" value="Suspended by admin"></div>`,`<button class="btn btn-warning" onclick="Suspended.doAdd('session','${sid}')">Suspend</button>`) }
};

const Suspended = {
    async render() {
        const r = await API.get('/api/admin/suspended');
        return `<div class="page-header"><div class="page-title"><h1>Suspended</h1><p>Disabled</p></div><div class="page-actions"><button class="btn btn-primary" onclick="Suspended.modal()">‚ûï Suspend</button></div></div><div class="card table-container"><table class="table"><thead><tr><th>Type</th><th>Value</th><th>Expires</th><th>Action</th></tr></thead><tbody>${(r.suspended||[]).map(s=>`<tr><td><span class="badge badge-info">${s.type}</span></td><td><code>${Utils.trunc(s.value,15)}</code></td><td>${s.expiresAt?Utils.fmtDate(s.expiresAt):'Permanent'}</td><td><button class="btn btn-success btn-sm" onclick="Suspended.del('${s.type}','${s.value}')">‚ñ∂Ô∏è Unsuspend</button></td></tr>`).join('')}</tbody></table></div>`;
    },
    async del(t,v){ if(confirm('Unsuspend?')){ await API.post('/api/admin/unsuspend',{type:t,value:v}); App.nav('suspended'); } },
    modal(){ App.openModal('Add Suspend',`<div class="form-group"><label class="form-label">Type</label><select id="suspType" class="form-select"><option value="userId">User ID</option><option value="hwid">HWID</option></select></div><div class="form-group"><label class="form-label">Value</label><input id="suspVal" class="form-input"></div><div class="form-group"><label class="form-label">Duration (sec)</label><input id="suspDur" class="form-input" type="number" placeholder="Empty = Permanent"></div>`,`<button class="btn btn-warning" onclick="Suspended.add()">Suspend</button>`) },
    async add(){ const t=document.getElementById('suspType').value,v=document.getElementById('suspVal').value; this.doAdd(t,v) },
    async doAdd(t,v){ const d=document.getElementById('suspDur').value; await API.post('/api/admin/suspend',{type:t,value:v,duration:d}); App.closeModal(); App.nav('suspended'); }
};

const Whitelist = {
    async render() {
        const r = await API.get('/api/admin/whitelist');
        const w=r.whitelist||{},list=[...(w.userIds||[]).map(v=>({t:'userId',v})),...(w.hwids||[]).map(v=>({t:'hwid',v})),...(w.ips||[]).map(v=>({t:'ip',v}))];
        return `<div class="page-header"><div class="page-title"><h1>Whitelist</h1><p>Bypass</p></div><div class="page-actions"><button class="btn btn-primary" onclick="Whitelist.modal()">‚ûï Add</button></div></div><div class="card table-container"><table class="table"><thead><tr><th>Type</th><th>Value</th><th>Action</th></tr></thead><tbody>${list.map(i=>`<tr><td>${i.t}</td><td><code>${i.v}</code></td><td><button class="btn btn-danger btn-sm" onclick="Whitelist.del('${i.t}','${i.v}')">üóëÔ∏è</button></td></tr>`).join('')||'<tr><td colspan="3" style="text-align:center">No whitelist</td></tr>'}</tbody></table></div>`;
    },
    async del(t,v){ if(confirm('Remove?')){ await API.post('/api/admin/whitelist/remove',{type:t,value:v}); App.nav('whitelist'); } },
    modal(){ App.openModal('Add Whitelist',`<div class="form-group"><label class="form-label">Type</label><select id="wlType" class="form-select"><option value="userId">User ID</option><option value="hwid">HWID</option><option value="ip">IP</option></select></div><div class="form-group"><label class="form-label">Value</label><input id="wlVal" class="form-input"></div>`,`<button class="btn btn-primary" onclick="Whitelist.add()">Add</button>`) },
    async add(){ const t=document.getElementById('wlType').value,v=document.getElementById('wlVal').value; if(v){ await API.post('/api/admin/whitelist',{type:t,value:v}); App.closeModal(); App.nav('whitelist'); } }
};

const Logs = {
    async render() {
        const r = await API.get('/api/admin/logs',{limit:50});
        return `<div class="page-header"><div class="page-title"><h1>Logs</h1></div><div class="page-actions"><button class="btn btn-secondary" onclick="App.nav('logs')">‚Üª Refresh</button><button class="btn btn-danger" onclick="Logs.clear()">üóëÔ∏è Clear</button></div></div><div class="card table-container"><table class="table"><thead><tr><th>Time</th><th>Action</th><th>Client/ID</th><th>IP</th><th>Status</th></tr></thead><tbody>${(r.logs||[]).map(l=>`<tr><td>${Utils.fmtDate(l.ts)}</td><td>${Utils.esc(l.action)}</td><td>${Utils.trunc(l.userId || l.hwid || l.client || '-', 15)}</td><td><code>${Utils.trunc(l.ip,12)}</code></td><td>${l.success?'<span class="badge badge-success">OK</span>':'<span class="badge badge-danger">FAIL</span>'}</td></tr>`).join('')}</tbody></table></div>`;
    },
    async clear(){ if(confirm('Clear ALL logs?')){ const r=await API.post('/api/admin/logs/clear'); if(r.success){ Utils.toast('Logs Cleared','success'); App.nav('logs'); }else{ Utils.toast('Failed','error'); } } }
};

const Settings = {
    render() {
        return `<div class="page-header"><div class="page-title"><h1>Settings</h1></div></div><div class="card" style="padding:24px"><h3>Loader Script</h3><p style="margin-bottom:16px;font-size:13px">Copy this into your executor:</p><code style="display:block;padding:16px;background:#000;border:1px solid var(--border);border-radius:8px;word-break:break-all">loadstring(game:HttpGet("${CONFIG.API_BASE}/loader"))()</code></div>`;
    }
};

// === APP ===
const App = {
    async init() {
        document.getElementById('loginBtn').onclick = Auth.login;
        document.querySelectorAll('.nav-item').forEach(el => {
            el.onclick = () => {
                if (window.innerWidth <= 768) this.toggleSidebar();
                this.nav(el.dataset.page);
            };
        });
        
        // Auto-login if key exists
        if (localStorage.getItem('ak')) {
            if (await Auth.check()) {
                this.showDash();
            } else {
                document.getElementById('loginScreen').style.display = 'flex';
            }
        } else {
            document.getElementById('loginScreen').style.display = 'flex';
        }
    },
    
    toggleSidebar() {
        document.querySelector('.sidebar').classList.toggle('open');
        document.querySelector('.sidebar-overlay').classList.toggle('active');
    },
    
    showDash() {
        document.getElementById('loginScreen').style.display = 'none';
        document.getElementById('dashboardScreen').classList.remove('hidden');
        this.nav('dashboard');
    },
    
    async nav(page) {
        document.querySelectorAll('.nav-item').forEach(el => {
            el.classList.toggle('active', el.dataset.page === page);
        });
        
        const content = document.getElementById('pageContent');
        content.innerHTML = '<div style="text-align:center;padding:40px"><div class="spinner"></div></div>';
        
        let html = '';
        try {
            switch(page) {
                case 'dashboard': html = await Dashboard.render(); break;
                case 'sessions': html = await Sessions.render(); break;
                case 'bans': html = await Bans.render(); break;
                case 'suspended': html = await Suspended.render(); break;
                case 'whitelist': html = await Whitelist.render(); break;
                case 'keys': html = Keys.render(); break;
                case 'logs': html = await Logs.render(); break;
                case 'settings': html = Settings.render(); break;
                default: html = await Dashboard.render();
            }
        } catch(e) {
            html = `<div style="padding:20px;text-align:center;color:var(--danger)">Error: ${e.message}</div>`;
        }
        
        content.innerHTML = html;
        
        if (page === 'dashboard' && Dashboard.postRender) {
            await Dashboard.postRender();
        }
        
        if (page === 'keys' && Keys.init) {
            await Keys.init();
        }
    },
    
    openModal(title, body, footer) {
        document.getElementById('modalTitle').innerText = title;
        document.getElementById('modalBody').innerHTML = body;
        document.getElementById('modalFooter').innerHTML = footer;
        document.getElementById('generalModal').classList.add('active');
    },
    
    closeModal() {
        document.getElementById('generalModal').classList.remove('active');
    }
};

document.addEventListener('DOMContentLoaded', () => App.init());

// Toast animation
const toastStyle = document.createElement('style');
toastStyle.textContent = `
@keyframes slideIn {
    from { transform: translateX(100%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
}
.toast-container {
    position: fixed;
    bottom: 20px;
    right: 20px;
    z-index: 1000;
    max-width: 300px;
}
`;
document.head.appendChild(toastStyle);
</script>
</body>
</html>